c************************************************************************
 
	subroutine taux_reac(x,t,ro,r,rt,rro,rx,rxx,q,qt,qro,qx,deriv)
 
c	cycles PP, CNO et 3 alpha
 
c	taux de reaction thermonucleaires
c	on utilise les tables de Caughlan et Fowler 1988
c                  une publi. de V. Landre
c                  des informations de B. Pichon (cours d'Aussois par ex.)
c	on calcule les derivees
c	evite les derivees numeriques pour l'energie
 
c	Auteur:
c              P. Morel, Departement J.D. Cassini, O.C.A., Observatoire de Nice i
c              D. Cordier, ENSCR
 
 
c references :
 
c 	Caughlan et Fowler Atomic Data and Nuclear Data Tables, 40, 283, 1988
 
c	B. Pichon DARC Observatoire de Paris-Meudon : calcul detaille des
c	energies liberees par les reactions thermonucleaires dans les chaines
c	PP et CNO, 1989
 
c	Landre V., Prantzos N., et al, 1990, A&A 240, 85 pour les reactions
c       O17(p,g)F18 et O17(p,a)N14
 
c entree :
c	x : proportion d'hydrogene en mole /g
c	t : temperature
c	ro : densite
 
c sortie :
c	r(i) : taux de reaction g /s /mole/mole (/mole)
c	rt, rro, rx(i), rxx(i) : derivee /t, /ro, /x, /x2  (due a X dans ecran)
c	q(i): energie ( erg /sec /gr )
c	qt, qro, qx : derivee /t, /ro, /x
 
c initialisation de COMMON
 
c	/reac_nuc/
c	nreac : nombre de reactions
c	t_inf : au dessous pas reactions nulles
 
	implicit none
 
	include 'cesam_3.parametres'
c	include 'modele_3.common'
	include 'ctephy.common'
	include 'evol_chim_3.common'
 
	integer pnt,pmrd
	parameter (pnt=60,pmrd=4)
 
	integer j,i,nrt,knot,l,nt,mrd,pecran(pnreac),nreac_tab
 
	logical init,deriv
	real*8 t_t(pnt),r_t(pnt*pnreac),f(pnt*pnreac),lnt9,t_infi,
     1	tt(pnt+pmrd),tr(pnt),drt(pnreac),st(pmrd*pnt*pnreac)
	real*8 t,ro,r(1),rt(1),rro(1),rx(1),q(1),qt(1),qro(1),qx(1),
     1	x,q0(pnreac),ecran,decrx,decr,zeta,decrt,rxx(1),decrxx,
     2	decrro,coef(pnreac)
 
	data t_t/0.001d0,0.002d0,0.003d0,0.004d0,0.005d0,0.006d0,0.007d0,
     1	0.008d0,0.009d0,0.010d0,0.011d0,0.012d0,0.013d0,0.014d0,
     2	0.015d0,0.016d0,0.018d0,0.020d0,0.025d0,0.030d0,0.040d0,
     3	0.050d0,0.060d0,0.070d0,0.080d0,0.090d0,0.100d0,0.110d0,
     4	0.120d0,0.130d0,0.140d0,0.150d0,0.160d0,0.180d0,0.200d0,
     5	0.250d0,0.300d0,0.350d0,0.400d0,0.450d0,0.500d0,0.600d0,
     6	0.700d0,0.800d0,0.900d0,1.000d0,1.250d0,1.500d0,1.750d0,
     7	2.000d0,2.500d0,3.000d0,3.500d0,4.000d0,5.000d0,6.000d0,
     8	7.000d0,8.000d0,9.000d0,1.000d1/
	
c	reaction 1 : h(p,e+ nu)h2    (INCHANGE)
 
	data(r_t(i),i=1,60)/  8.60d-28,5.84D-25,1.34d-23,9.46d-23,3.78d-22,
     1	   1.08d-21,2.49d-21,4.93d-21,8.79d-21,1.44d-20,2.22d-20,
     2	   3.25d-20,4.57d-20,6.20d-20,8.18d-20,1.05d-19,1.64d-19,
     3	   2.41d-19,5.16d-19,9.18d-19,2.11d-18,3.80d-18,5.92d-18,
     4	   8.43d-18,1.13d-17,1.44d-17,1.77d-17,2.13d-17,2.51d-17,
     5	   2.90d-17,3.30d-17,3.71d-17,4.14d-17,5.01d-17,5.91d-17,
     6	   8.24d-17,1.06d-16,1.30d-16,1.55d-16,1.79d-16,2.03d-16,
     7	   2.50d-16,2.97d-16,3.42d-16,3.87d-16,4.30d-16,5.35d-16,
     8	   6.35d-16,7.31d-16,8.22d-16,9.96d-16,1.16d-15,1.31d-15,
     9	   1.46d-15,1.73d-15,1.98d-15,2.21d-15,2.43d-15,2.63d-15,
     1	   2.83d-15/
 
c	reaction 2 : h2(p,g)he3      (INCHANGE)
 
	data(r_t(i),i=61,120)/1.64d-11,2.28d-08,7.47d-07,6.58d-06,3.09d-05,
     1	   1.00d-04,2.55d-04,5.52d-04,1.06d-03,1.85d-03,3.01d-03,
     2	   4.63d-03,6.80d-03,9.63d-03,1.32d-02,1.76d-02,2.92d-02,
     3	   4.53d-02,1.09d-01,2.11d-01,5.57d-01,1.11d+00,1.88d+00,
     4	   2.86d+00,4.06d+00,5.45d+00,7.03d+00,8.79d+00,1.07d+01,
     5	   1.28d+01,1.50d+01,1.74d+01,1.99d+01,2.53d+01,3.11d+01,
     6	   4.73d+01,6.53d+01,8.48d+01,1.05d+02,1.27d+02,1.49d+02,
     7	   1.95d+02,2.42d+02,2.90d+02,3.39d+02,3.88d+02,5.10d+02,
     8	   6.32d+02,7.52d+02,8.70d+02,1.10d+03,1.32d+03,1.53d+03,
     9	   1.73d+03,2.12d+03,2.48d+03,2.81d+03,3.13d+03,3.44d+03,
     1	   3.73d+03/
 
c	reaction 3 : he3(he3,2p)he4  (INCHANGE)
 
	data(r_t(i),i=121,180)/2.93d-41,1.83d-30,3.12d-25,6.17d-22,1.36d-19,
     1	    8.27d-18,2.20d-16,3.28d-15,3.22d-14,2.29d-13,1.28d-12,
     2	    5.83d-12,2.27d-11,7.70d-11,2.34d-10,6.45d-10,3.88d-09,
     3	    1.82d-08,3.99d-07,4.18d-06,1.27d-04,1.42d-03,8.88d-03,
     4	    3.83d-02,1.27d-01,3.50d-01,8.35d-01,1.78d+00,3.48d+00,
     5	    6.32d+00,1.08d+01,1.76d+01,2.74d+01,6.01d+01,1.18d+02,
     6	    4.51d+02,1.25d+03,2.80d+03,5.45d+03,9.55d+03,1.55d+04,
     7	    3.46d+04,6.59d+04,1.13d+05,1.79d+05,2.69d+05,6.20d+05,
     8	    1.21d+06,2.12d+06,3.42d+06,7.56d+06,1.43d+07,2.43d+07,
     9	    3.81d+07,7.94d+07,1.42d+08,2.28d+08,3.41d+08,4.81d+08,
     1	    6.50d+08/
 
 
c	reaction 4 : he4(he3,g)be7   (INCHANGE)
 
	data(r_t(i),i=181,240)/1.11d-47,2.17d-36,6.41d-31,1.80d-27,5.07d-25,
     1	    3.74d-23,1.16d-21,1.96d-20,2.14d-19,1.67d-18,1.01d-17,
     2	    4.94d-17,2.05d-16,7.37d-16,2.36d-15,6.83d-15,4.48d-14,
     3	    2.26d-13,5.74d-12,6.73d-11,2.41d-09,3.04d-08,2.09d-07,
     4	    9.69d-07,3.42d-06,9.92d-06,2.47d-05,5.49d-05,1.11d-04,
     5	    2.08d-04,3.66d-04,6.11d-04,9.75d-04,2.23d-03,4.52d-03,
     6	    1.85d-02,5.37d-02,1.25d-01,2.50d-01,4.46d-01,7.33d-01,
     7	    1.65d+00,3.12d+00,5.26d+00,8.13d+00,1.18d+01,2.44d+01,
     8	    4.19d+01,6.38d+01,8.95d+01,1.49d+02,2.17d+02,2.88d+02,
     9	    3.59d+02,4.97d+02,6.21d+02,7.28d+02,8.19d+02,8.95d+02,
     1	    9.56d+02/
 
c	reaction 5 : li7(p,a)he4     (INCHANGE)
 
	data(r_t(i),i=241,300)/1.00d-26,2.49d-19,9.41d-16,1.68d-13,6.70d-12,
     1	    1.11d-10,1.04d-09,6.57d-09,3.12d-08,1.19d-07,3.84d-07,
     2	    1.08d-06,2.73d-06,6.28d-06,1.34d-05,2.67d-05,9.09d-05,
     3	    2.60d-04,2.14d-03,1.06d-02,1.09d-01,5.65d-01,1.98d+00,
     4	    5.37d+00,1.22d+01,2.44d+01,4.43d+01,7.44d+01,1.18d+02,
     5	    1.77d+02,2.56d+02,3.58d+02,4.85d+02,8.31d+02,1.32d+03,
     6	    3.30d+03,6.62d+03,1.15d+04,1.80d+04,2.62d+04,3.62d+04,
     7	    6.12d+04,9.26d+04,1.30d+05,1.72d+05,2.18d+05,3.50d+05,
     8	    4.97d+05,6.53d+05,8.15d+05,1.16d+06,1.55d+06,2.05d+06,
     9	    2.74d+06,4.78d+06,7.64d+06,1.10d+07,1.44d+07,1.76d+07,
     1	    2.06d+07/
 
c	reaction 6 : be7(e-,nu g)li7  (INCHANGE)
 
	data(r_t(i),i=301,360)/1.46d-07,1.72d-08,7.55d-09,4.83d-09,3.63d-09,
     1	    2.97d-09,2.55d-09,2.26d-09,2.05d-09,1.89d-09,1.76d-09,
     2	    1.66d-09,1.57d-09,1.50d-09,1.44d-09,1.38d-09,1.30d-09,
     3	    1.22d-09,1.10d-09,1.01d-09,8.98d-10,8.29d-10,7.81d-10,
     4	    7.47d-10,7.20d-10,6.99d-10,6.82d-10,6.68d-10,6.57d-10,
     5	    6.47d-10,6.38d-10,6.31d-10,6.24d-10,6.14d-10,6.05d-10,
     6	    5.91d-10,5.82d-10,5.77d-10,5.73d-10,5.72d-10,5.71d-10,
     7	    5.70d-10,5.72d-10,5.74d-10,5.77d-10,5.80d-10,5.88d-10,
     8	    5.96d-08,6.04d-10,6.11d-10,6.26d-10,6.39d-10,6.51d-10,
     9	    6.62d-10,6.81d-10,6.99d-10,7.14d-10,7.28d-10,7.41d-10,
     1	    7.53d-10/
 
c	reaction 7 : be7(p,g)b8       (INCHANGE)
 
	data(r_t(i),i=361,420)/8.42d-38,8.30d-29,1.88d-24,1.04d-21,9.20d-20,
     1	    2.80d-18,4.28d-17,4.05d-16,2.70d-15,1.38d-14,5.74d-14,
     2	    2.03d-13,6.25d-13,1.73d-12,4.34d-12,1.01d-11,4.47d-11,
     3	    1.61d-10,2.08d-09,1.46d-08,2.47d-07,1.83d-06,8.38d-06,
     4	    2.81d-05,7.60d-05,1.76d-04,3.61d-04,6.77d-04,1.18d-03,
     5	    1.93d-03,3.01d-03,4.51d-03,6.52d-03,1.25d-02,2.18d-02,
     6	    6.60d-02,1.53d-01,2.97d-01,5.12d-01,8.10d-01,1.20d+00,
     7	    2.30d+00,3.90d+00,6.09d+00,8.96d+00,1.26d+01,2.48d+01,
     8	    4.09d+01,5.97d+01,8.00d+01,1.22d+02,1.64d+02,2.04d+02,
     9	    2.43d+02,3.16d+02,3.83d+02,4.46d+02,5.04d+02,5.59d+02,
     1	    6.11d+02/
 
 
c	reaction 8 : c12(p,g)n13      (INCHANGE)
 
	data(r_t(i),i=421,480)/7.27d-51,8.51d-39,6.04d-33,2.95d-29,1.24d-26,
     1	    1.24d-24,4.88d-23,1.01d-21,1.31d-20,1.19d-19,8.18d-19,
     2	    4.51d-18,2.07d-17,8.19d-17,2.86d-16,8.96d-16,6.76d-15,
     3	    3.85d-14,1.26d-12,1.79d-11,8.57d-10,1.34d-08,1.10d-07,
     4	    5.86d-07,2.34d-06,7.54d-06,2.07d-05,5.01d-05,1.10d-04,
     5	    2.21d-04,4.16d-04,7.40d-04,1.25d-03,3.20d-03,7.18d-03,
     6	    3.87d-02,1.75d-01,7.46d-01,2.70d+00,7.89d+00,1.90d+01,
     7	    7.10d+01,1.79d+02,3.52d+02,5.86d+02,8.68d+02,1.69d+03,
     8	    2.52d+03,3.24d+03,3.77d+03,4.31d+03,4.40d+03,4.34d+03,
     9	    4.26d+03,4.12d+03,3.94d+03,3.75d+03,3.56d+03,3.37d+03,
     1	    3.19d+03/
 
c	reaction 9 : c13(p,g)n14      (INCHANGE)
 
	data(r_t(i),i=481,540)/2.17d-50,2.69d-38,1.96d-32,9.71d-29,4.12d-26,
     1	    4.15d-24,1.65d-22,3.44d-21,4.47d-20,4.07d-19,2.81d-18,
     2	    1.55d-17,7.14d-17,2.83d-16,9.90d-16,3.11d-15,2.35d-14,
     3	    1.34d-13,4.39d-12,6.27d-11,3.01d-09,4.71d-08,3.84d-07,
     4	    2.05d-06,8.15d-06,2.62d-05,7.18d-05,1.73d-04,3.78d-04,
     5	    7.59d-04,1.43d-03,2.53d-03,4.27d-03,1.08d-02,2.41d-02,
     6	    1.22d-01,4.46d-01,1.48d+00,4.91d+00,1.51d+01,4.04d+01,
     7	    1.92d+02,5.95d+02,1.38d+03,2.62d+03,4.34d+03,1.04d+04,
     8	    1.80d+04,2.60d+04,3.35d+04,4.55d+04,5.27d+04,5.62d+04,
     9	    5.73d+04,5.66d+04,5.46d+04,5.19d+04,4.89d+04,4.60d+04,
     1	    4.32d+04/
 
c	reaction 10 : n14(p,g)O15(e+ nu)n15    (INCHANGE)
 
	data(r_t(i),i=541,600)/3.58d-57,9.88d-44,3.25d-37,4.17d-33,3.47d-30,
     1	    5.85d-28,3.50d-26,1.02d-24,1.77d-23,2.06d-22,1.75d-21,
     2	    1.17d-20,6.38d-20,2.94d-19,1.18d-18,4.19d-18,3.95d-17,
     3	    2.73d-16,1.30d-14,2.46d-13,1.76d-11,3.64d-10,3.64d-09,
     3	    2.27d-08,1.02d-07,3.65d-07,1.09d-06,2.89d-06,7.21d-06,
     4	    1.81d-05,4.75d-05,1.28d-04,3.35d-04,1.92d-03,8.20d-03,
     5	    1.14d-01,6.41d-01,2.13d+00,5.10d+00,9.87d+00,1.65d+01,
     6	    3.43d+01,5.60d+01,7.89d+01,1.01d+02,1.22d+02,1.66d+02,
     7	    2.03d+02,2.43d+02,2.95d+02,4.66d+02,7.42d+02,1.11d+03,
     8	    1.53d+03,2.38d+03,3.17d+03,3.94d+03,4.73d+03,5.53d+03,
     9	    6.32d+03/
 
c	reaction 11 : n15(p,g)o16        (INCHANGE)
 
	data(r_t(i),i=601,660)/5.73d-56,1.67d-42,5.66d-36,7.42d-32,6.28d-29,
     1	    1.07d-26,6.49d-25,1.92d-23,3.35d-22,3.93d-21,3.38d-20,
     2	    2.27d-19,1.25d-18,5.80d-18,2.34d-17,8.40d-17,8.03d-16,
     3	    5.61d-15,2.76d-13,5.38d-12,4.08d-10,8.90d-09,9.36d-08,
     4	    6.14d-07,2.91d-06,1.08d-05,3.37d-05,9.11d-05,2.20d-04,
     5	    4.85d-04,9.93d-04,1.92d-03,3.54d-03,1.10d-02,3.09d-02,
     6	    2.87d-01,1.57d+00,5.56d+00,1.45d+01,3.03d+01,5.42d+01,
     7	    1.27d+02,2.25d+02,3.39d+02,4.67d+02,6.18d+02,1.21d+03,
     8	    2.33d+03,4.14d+03,6.61d+03,1.29d+04,1.97d+04,2.60d+04,
     9	    3.12d+04,3.83d+04,4.19d+04,4.31d+04,4.29d+04,4.19d+04,
     1	    4.04d+04/
 
c	reaction 12 : n15(p,a)c12         (INCHANGE)
 
	data(r_t(i),i=661,720)/6.49d-53,1.92d-39,6.57d-33,8.69d-29,7.42d-26,
     1	    1.28d-23,7.79d-22,2.32d-20,4.07d-19,4.81d-18,4.17d-17,
     2	    2.82d-16,1.56d-15,7.27d-15,2.95d-14,1.06d-13,1.03d-12,
     3	    7.23d-12,3.62d-12,7.18d-09,5.60d-07,1.25d-05,1.34d-04,
     4	    8.89d-04,4.25d-03,1.60d-02,5.02d-02,1.36d-01,3.31d-01,
     5	    7.31d-01,1.50d+00,2.90d+00,5.36d+00,1.68d+01,5.01d+01,
     6	    6.09d+01,4.29d+03,1.81d+04,5.34d+04,1.22d+05,2.34d+05,
     7	    6.00d+05,1.13d+06,1.78d+06,2.47d+06,3.19d+06,5.00d+06,
     8	    6.95d+06,9.17d+06,1.17d+07,1.77d+07,2.43d+07,3.10d+07,
     9	    3.74d+07,4.86d+07,5.74d+07,6.41d+07,6.91d+07,7.29d+07,
     1	    7.56d+07/
 
c	reaction 13 :o16(p,g)f17(e+ nu)o17     (INCHANGE)
 
	data(r_t(i),i=721,780)/4.75d-63,2.68d-48,3.81d-41,1.23d-36,1.98d-33,
     1	    5.52d-31,4.93d-29,2.00d-27,4.59d-26,6.79d-25,7.15d-24,
     2	    5.75d-23,3.70d-22,1.98d-21,9.11d-21,3.67d-20,4.32d-19,
     3	    3.60d-18,2.51d-16,6.35d-15,6.94d-13,1.93d-11,2.43d-10,
     4	    1.82d-09,9.55d-09,3.86d-08,1.28d-07,3.65d-07,9.20d-07,
     5	    2.10d-06,4.41d-06,8.65d-06,1.60d-05,4.73d-05,1.20d-04,
     6	    7.66d-04,3.12d-03,9.48d-03,2.36d-02,5.09d-02,9.82d-02,
     7	    2.88d-01,6.75d-01,1.36d+00,2.44d+00,4.02d+00,1.09d+01,
     8	    2.30d+01,4.17d+01,6.77d+01,1.44d+02,2.55d+02,4.00d+02,
     9	    5.79d+02,1.03d+03,1.58d+03,2.23d+03,2.95d+03,3.73d+03,
     1	    4.56d+03/	
 
c	reaction 14 : o17(p,a)n14  (Landre V. et al, 1990)
 
      data(r_t(i),i=781,840)/.115d-60, .341d-46, .325d-39, .786d-35,
     +  .101d-31, .237d-29,
     +  .185d-27, .674d-26, .142d-24, .197d-23, .198d-22, .153d-21,
     +  .966d-21, .512d-20, .234d-19, .956d-19, .135d-17, .234d-16,
     +  .219d-13, .269d-11, .104d-08, .344d-07, .337d-06, .166d-05,
     +  .537d-05, .132d-04, .276d-04, .540d-04, .107d-03, .225d-03,
     +  .480d-03, .101d-02, .200d-02, .664d-02, .178d-01, .129d+00,
     +  .920d+00, .613d+01, .297d+02, .106d+03, .301d+03, .148d+04,
     +  .474d+04, .116d+05, .235d+05, .418d+05, .122d+06, .258d+06,
     +  .451d+06, .699d+06, .134d+07, .213d+07, .304d+07, .404d+07,
     +  .624d+07, .863d+07, .111d+08, .137d+08, .164d+08, .191d+08/
 
c	reaction 15 : N13(p,g)O14(e+nu)N14  (CNO chaud non pris en compte
c       pour le moment, valeur arbitraire de 1.d-10 pour eviter des pb.
c       avec les log)
 
      data(r_t(i),i=841,900)/.100d-09, .100d-09, .100d-09, .100d-09,
     +  .100d-09, .100d-09,
     +  .100d-09, .100d-09, .100d-09, .100d-09, .100d-09, .100d-09,
     +  .100d-09, .100d-09, .100d-09, .100d-09, .100d-09, .100d-09,
     +  .100d-09, .100d-09, .100d-09, .100d-09, .100d-09, .100d-09,
     +  .100d-09, .100d-09, .100d-09, .100d-09, .100d-09, .100d-09,
     +  .100d-09, .100d-09, .100d-09, .100d-09, .100d-09, .100d-09,
     +  .100d-09, .100d-09, .100d-09, .100d-09, .100d-09, .100d-09,
     +  .100d-09, .100d-09, .100d-09, .100d-09, .100d-09, .100d-09,
     +  .100d-09, .100d-09, .100d-09, .100d-09, .100d-09, .100d-09,
     +  .100d-09, .100d-09, .100d-09, .100d-09, .100d-09, .100d-09/
 
c	reaction 16 : O17(p,g)F18(e+nu)O18 (Landre V., et al 1990)
 
      data(r_t(i),i=901,960)/.579d-62, .334d-47, .478d-40, .155d-35,
     +  .249d-32, .691d-30,
     +  .616d-28, .250d-26, .570d-25, .842d-24, .885d-23, .709d-22,
     +  .456d-21, .244d-20, .112d-19, .450d-19, .530d-18, .454d-17,
     +  .532d-15, .365d-13, .120d-10, .393d-09, .392d-08, .201d-07,
     +  .695d-07, .189d-06, .447d-06, .975d-06, .204d-05, .417d-05,
     +  .838d-05, .165d-04, .317d-04, .106d-03, .311d-03, .267d-02,
     +  .132d-01, .493d-01, .168d+00, .539d+00, .155d+01, .873d+01,
     +  .314d+02, .820d+02, .172d+03, .309d+03, .862d+03, .166d+04,
     +  .260d+04, .359d+04, .550d+04, .716d+04, .857d+04, .977d+04,
     +  .118d+05, .135d+05, .151d+05, .166d+05, .182d+05, .197d+05/
 
c	reaction 17 : O18(p,g)F19
 
      data(r_t(i),i=961,1020)/.789d-62, .493d-47, .745d-40, .294d-35,
     +  .347d-31, .524d-28,
     +  .101d-25, .508d-24, .105d-22, .118d-21, .839d-21, .430d-20,
     +  .171d-19, .568d-19, .164d-18, .434d-18, .263d-17, .150d-16,
     +  .843d-15, .222d-13, .276d-11, .130d-09, .103d-07, .395d-06,
     +  .628d-05, .533d-04, .291d-03, .115d-02, .357d-02, .923d-02,
     +  .207d-01, .413d-01, .752d-01, .201d+00, .434d+00, .165d+01,
     +  .382d+01, .671d+01, .999d+01, .134d+02, .168d+02, .238d+02,
     +  .331d+02, .480d+02, .721d+02, .109d+03, .273d+03, .553d+03,
     +  .947d+03, .144d+04, .265d+04, .407d+04, .560d+04, .717d+04,
     +  .103d+05, .134d+05, .164d+05, .191d+05, .218d+05, .243d+05/
 
c	reaction 18 : F19(p,a)O16
 
      data(r_t(i),i=1021,1080)/.787d-65, .850d-49, .512d-41, .415d-36,
     +  .129d-32, .592d-30,
     +  .793d-28, .451d-26, .137d-24, .260d-23, .340d-22, .332d-21,
     +  .254d-20, .159d-19, .845d-19, .389d-18, .578d-17, .592d-16,
     +  .626d-14, .219d-12, .391d-10, .156d-08, .261d-07, .248d-06,
     +  .159d-05, .767d-05, .298d-04, .976d-04, .281d-03, .736d-03,
     +  .183d-02, .447d-02, .111d-01, .681d-01, .367d+00, .956d+01,
     +  .863d+02, .410d+03, .132d+04, .335d+04, .728d+04, .261d+05,
     +  .730d+05, .167d+06, .327d+06, .563d+06, .150d+07, .288d+07,
     +  .454d+07, .637d+07, .102d+08, .137d+08, .169d+08, .196d+08,
     +  .237d+08, .264d+08, .281d+08, .291d+08, .297d+08, .301d+08/
 
c	reaction 19 : F19(p,g)Ne20
 
      data(r_t(i),i=1081,1140)/.134d-68, .145d-52, .873d-45, .707d-40,
     +  .219d-36, .101d-33,
     +  .135d-31, .770d-30, .234d-28, .444d-27, .582d-26, .567d-25,
     +  .434d-24, .272d-23, .145d-22, .665d-22, .990d-21, .101d-19,
     +  .107d-17, .375d-16, .669d-14, .267d-12, .445d-11, .421d-10,
     +  .269d-09, .129d-08, .496d-08, .162d-07, .461d-07, .120d-06,
     +  .296d-06, .723d-06, .180d-05, .112d-04, .615d-04, .163d-02,
     +  .151d-01, .761d-01, .269d+00, .764d+00, .187d+01, .797d+01,
     +  .239d+02, .551d+02, .105d+03, .175d+03, .429d+03, .759d+03,
     +  .112d+04, .149d+04, .216d+04, .273d+04, .317d+04, .350d+04,
     +  .391d+04, .409d+04, .413d+04, .410d+04, .404d+04, .395d+04/
 
c	reaction 20 : O18(p,a)N15
 
      data(r_t(i),i=1141,1200)/.825d-59, .512d-44, .770d-37, .262d-32,
     +  .671d-29, .528d-26,
     +  .900d-24, .445d-22, .936d-21, .108d-19, .826d-19, .472d-18,
     +  .222d-17, .917d-17, .348d-16, .123d-15, .128d-14, .103d-13,
     +  .736d-12, .195d-10, .233d-08, .775d-07, .242d-05, .701d-04,
     +  .105d-02, .879d-02, .476d-01, .188d+00, .583d+00, .151d+01,
     +  .338d+01, .675d+01, .123d+02, .329d+02, .712d+02, .274d+03,
     +  .653d+03, .121d+04, .201d+04, .333d+04, .614d+04, .272d+05,
     +  .110d+06, .336d+06, .812d+06, .164d+07, .566d+07, .125d+08,
     +  .213d+08, .312d+08, .507d+08, .673d+08, .805d+08, .904d+08,
     +  .102d+09, .107d+09, .107d+09, .106d+09, .103d+09, .991d+08/
 
c	reaction 21 : he4(2a,g)c12    (triple alfa)  (INCHANGE)
 
	data(r_t(i),i=1201,1260)/1.64d-157,1.13d-124,9.87d-109,1.39d-98,
     1	2.02d-91,5.95d-86,1.39d-81,5.63d-78,6.33d-75,2.69d-72,
     2	5.36d-70,5.84d-68,3.88d-66,1.72d-64,5.44d-63,1.31d-61,
     3	3.95d-59,6.10d-57,2.71d-52,6.27d-48,2.88d-41,6.08d-37,
     4	6.96d-34,1.78d-31,7.69d-29,2.18d-26,2.11d-24,8.69d-23,
     5	1.88d-21,2.49d-20,2.24d-19,1.48d-18,7.64d-18,1.14d-16,
     6	9.60d-16,4.01d-14,4.37d-13,2.24d-12,7.23d-12,1.73d-11,
     7	3.35d-11,8.40d-11,1.51d-10,2.22d-10,2.87d-10,3.42d-10,
     8	4.22d-10,4.39d-10,4.21d-10,3.86d-10,3.07d-10,2.39d-10,
     9	1.87d-10,1.48d-10,1.01d-10,7.67d-11,6.44d-11,5.83d-11,
     1	5.52d-11,5.37d-11/
 
c	reaction 22 : c12(a,g)o16   (INCHANGE)
 
	data(r_t(i),i=1261,1320)/3.32d-126,4.97d-98,2.19d-84,8.62d-76,1.10d-69,
     1	4.92d-65,2.53d-61,2.89d-58,1.11d-55,1.85d-53,1.62d-51,
     2	2.66d-50,9.64d-49,2.45d-47,4.63d-46,6.80d-45,7.85d-43,
     3	4.67d-41,1.65d-37,8.28d-35,6.93d-31,4.17d-28,5.40d-26,
     4	2.59d-24,6.27d-23,9.19d-22,9.23d-21,6.90d-20,4.08d-19,
     5	1.99d-18,8.30d-18,3.03d-17,9.85d-17,7.92d-16,4.74d-15,
     6	1.67d-13,2.48d-12,2.10d-11,1.21d-10,5.27d-10,1.86d-09,
     7	1.46d-08,7.43d-08,2.81d-07,8.56d-07,2.22d-06,1.49d-05,
     8	6.94d-05,2.88d-04,1.09d-03,9.70d-03,4.91d-02,1.72d-01,
     9	4.80d-01,2.50d+00,9.30d+00,2.76d+01,6.92d+01,1.53d+02,
     1	3.05d+02/
 
c	reaction 23 : o16(a,g)ne20  (INCHANGE)
 
	data(r_t(i),i=1321,1380)/2.04d-161,5.36d-126,8.63d-109,6.31d-98,
     1	3.41d-90,2.71d-84,1.40d-79,1.09d-75,2.13d-72,1.45d-69,
     2	4.37d-67,6.84d-65,6.27d-63,3.70d-61,1.50d-59,4.44d-58,
     3	1.79d-55,2.59d-54,9.77d-49,2.62d-45,2.61d-40,9.35d-37,
     4	4.80d-34,7.01d-32,4.27d-30,1.38d-28,2.74d-27,3.74d-26,
     5	3.78d-25,2.99d-24,1.93d-23,1.05d-22,4.94d-22,7.74d-21,
     6	1.11d-19,6.55d-16,4.76d-13,5.19d-11,1.74d-09,2.66d-08,
     7	2.36d-07,6.34d-06,6.72d-05,3.97d-04,1.58d-03,4.73d-03,
     8	3.35d-02,1.20d-01,2.90d-01,5.51d-01,1.31d+00,2.29d+00,
     9	3.51d+00,5.13d+00,1.07d+01,2.20d+01,4.19d+01,7.34d+01,
     1	1.19d+02,1.80d+02/
 
c	reaction 24 : Ne20(a,g)Mg24
 
      data(r_t(i),i=1381,1440)/.328d-189,.165d-147,.303d-127,.189d-114,
     +  .243d-105, .217d-98,
     +  .780d-93, .300d-88, .226d-84, .495d-81, .413d-78, .160d-75,
     +  .329d-73, .402d-71, .317d-69, .172d-67, .203d-64, .898d-62,
     +  .181d-56, .202d-52, .161d-46, .256d-42, .410d-39, .149d-36,
     +  .194d-34, .119d-32, .412d-31, .917d-30, .148d-28, .331d-27,
     +  .238d-25, .156d-23, .634d-22, .304d-19, .419d-17, .287d-13,
     +  .100d-10, .644d-09, .144d-07, .159d-06, .108d-05, .188d-04,
     +  .143d-03, .658d-03, .223d-02, .627d-02, .538d-01, .306d+00,
     +  .123d+01, .369d+01, .185d+02, .560d+02, .125d+03, .229d+03,
     +  .529d+03, .904d+03, .130d+04, .168d+04, .202d+04, .234d+04/
 
c	reaction 25 : C13(a,n)O16
 
      data(r_t(i),i=1441,1500)/.273d-122,.161d-93,.152d-79,.101d-70,
     +  .192d-64, .119d-59,
     +  .800d-56, .116d-52, .542d-50, .109d-47, .112d-45, .677d-44,
     +  .266d-42, .728d-41, .148d-39, .231d-38, .302d-36, .200d-34,
     +  .900d-31, .551d-28, .638d-24, .498d-21, .801d-19, .464d-17,
     +  .132d-15, .225d-14, .258d-13, .218d-12, .144d-11, .781d-11,
     +  .358d-10, .143d-09, .508d-09, .478d-08, .330d-07, .158d-05,
     +  .301d-04, .320d-03, .228d-02, .123d-01, .530d-01, .587d+00,
     +  .380d+01, .168d+02, .561d+02, .154d+03, .110d+04, .487d+04,
     +  .160d+05, .417d+05, .175d+06, .483d+06, .102d+07, .178d+07,
     +  .378d+07, .606d+07, .827d+07, .102d+08, .119d+08, .132d+08/
 
c	reaction 26 : O17(a,n)Ne20
 
      data(r_t(i),i=1501,1560)/.464d-153,.168d-117,.317d-100,.255d-89,
     +  .148d-81, .124d-75,
     +  .671d-71, .540d-67, .108d-63, .757d-61, .233d-58, .371d-56,
     +  .346d-54, .207d-52, .853d-51, .256d-49, .105d-46, .187d-44,
     +  .607d-40, .168d-36, .173d-31, .636d-28, .332d-25, .491d-23,
     +  .302d-21, .981d-20, .196d-18, .269d-17, .273d-16, .216d-15,
     +  .140d-14, .761d-14, .358d-13, .554d-12, .584d-11, .649d-09,
     +  .233d-07, .403d-06, .420d-05, .303d-04, .165d-03, .265d-02,
     +  .240d-01, .145d+00, .659d+00, .239d+01, .305d+02, .203d+03,
     +  .886d+03, .289d+04, .171d+05, .607d+05, .155d+06, .318d+06,
     +  .854d+06, .158d+07, .234d+07, .298d+07, .344d+07, .371d+07/
 
c	reaction 27 : N14(a,g)F18(e+nu)O18
 
      data(r_t(i),i=1561,1620)/.261d-144,.318d-112,.123d-96,.851d-87,
     +  .860d-80, .191d-74,
     +  .356d-70, .119d-66, .114d-63, .421d-61, .741d-59, .721d-57,
     +  .433d-55, .174d-53, .500d-52, .108d-50, .247d-48, .267d-46,
     +  .318d-42, .410d-39, .141d-34, .343d-31, .967d-28, .564d-25,
     +  .680d-23, .307d-21, .125d-19, .677d-18, .254d-16, .568d-15,
     +  .814d-14, .814d-13, .607d-12, .170d-10, .241d-09, .270d-07,
     +  .596d-06, .525d-05, .261d-04, .892d-04, .234d-03, .979d-03,
     +  .287d-02, .789d-02, .228d-01, .648d-01, .549d+00, .243d+01,
     +  .703d+01, .154d+02, .455d+02, .914d+02, .148d+03, .210d+03,
     +  .335d+03, .448d+03, .542d+03, .617d+03, .677d+03, .723d+03/
 
c	reaction 28 : O18(a,g)Ne22
 
      data(r_t(i),i=1621,1680)/.199d-159,.979d-124,.214d-106,.190d-95,
     +  .118d-87, .105d-81,
     +  .593d-77, .496d-73, .103d-69, .740d-67, .233d-64, .381d-62,
     +  .363d-60, .221d-58, .928d-57, .283d-55, .120d-52, .228d-50,
     +  .291d-43, .131d-37, .140d-30, .214d-26, .126d-23, .115d-21,
     +  .331d-20, .442d-19, .346d-18, .184d-17, .731d-17, .235d-16,
     +  .692d-16, .266d-15, .178d-14, .950d-13, .258d-11, .973d-09,
     +  .499d-07, .828d-06, .678d-05, .347d-04, .128d-03, .892d-03,
     +  .352d-02, .968d-02, .210d-01, .386d-01, .119d+00, .323d+00,
     +  .988d+00, .299d+01, .181d+02, .657d+02, .171d+03, .358d+03,
     +  .104d+04, .220d+04, .385d+04, .596d+04, .849d+04, .114d+05/
 
c	reaction 29 : Ne22(a,n)Mg25 (on a mis arbitrairement les 7
c	premiere valeurs egales a .2-306 pour eviter des pb. avec
c	les log (sinon on a 0.! et log 0.!!!)
 
      data(r_t(i),i=1681,1740)/.200d-306,.200d-306,.200d-306,
     + .200d-306, .200d-306, .200d-306,
     + .200d-306,.252d-306,.110d-272,.896d-246,.936d-224,.209d-205,
     + .701d-190,.143d-176,.487d-165,.602d-155,.398d-138,.114d-124,
     + .189d-100,.265d-84, .404d-64, .521d-52, .618d-44, .361d-38,
     + .763d-34,.176d-30, .866d-28, .138d-25, .950d-24, .367d-22,
     + .993d-21,.194d-19, .263d-18, .187d-16, .530d-15, .237d-12,
     + .186d-10,.562d-09, .913d-08, .953d-07, .714d-06, .194d-04,
     + .267d-03,.230d-02, .140d-01, .660d-01, .144d+01, .146d+02,
     + .909d+02,.403d+03, .401d+04, .219d+05, .808d+05, .228d+06,
     + .106d+07,.311d+07, .694d+07, .129d+08, .212d+08, .318d+08/
 
c	reaction 30 : Ne22(a,g)Mg26 (les 5 denieres valeurs ont ete
c	prises egales a .2d-247 pour eviter des pb. avec les log)
 
      data(r_t(i),i=1741,1800)/.302d-182,.245d-140,.567d-120,.408d-107,
     +  .579d-98, .559d-91,
     +  .213d-85, .859d-81, .673d-77, .152d-73, .131d-70, .519d-68,
     +  .109d-65, .136d-63, .109d-61, .603d-60, .729d-57, .330d-54,
     +  .691d-49, .790d-45, .647d-39, .103d-34, .164d-31, .588d-29,
     +  .746d-27, .444d-25, .149d-23, .317d-22, .472d-21, .524d-20,
     +  .456d-19, .322d-18, .191d-17, .435d-16, .620d-15, .109d-12,
     +  .456d-11, .713d-10, .544d-09, .237d-08, .654d-08, .165d-07,
     +  .124d-07, .340d-08, .386d-09, .195d-10, .468d-15, .178d-21,
     +  .152d-29,.373d-39,.121d-62,.258d-91,.132d-124,.531d-162,
     +  .295d-247,.2d-247,.2d-247,.2d-247,.2d-247,.2d-247/
 
	data init/.false./
 
	save
 
2000	format((1x,1p8d10.3))
 
	if(.not. init)then	!en cas de modifications assurer la coherence
	 init=.true.		!avec reac_nuc
 
c	 ATTENTION nreac: nb. de reac. utilisees, nreac_tab: nb. reac. tabulees
 
	 nreac_tab=30	!nombre de reactions tabulees
	 nreac=30	!nombre de reactions utilisees
	 nt=60
	 lnt9=log(1.d9)
	 do i=1,nt
	  t_t(i)=log(t_t(i))+lnt9
	  do j=1,nreac_tab
	   if(r_t(nt*(j-1)+i) .le. 0.d0)then
	    write(6,*)'r .le. 0; i temp., j reac., r',i,j,r(nt*(j-1)+i)
	    stop
	   endif
	   f(nreac_tab*(i-1)+j)=log(r_t(nt*(j-1)+i))	!r(t,reac), f(reac,t)
	  enddo !i
	 enddo	!j
c	 write(6,2000)(t_t(i),i=1,nt)
c	 write(6,2000)(exp(t_t(i)),i=1,nt)
 
c	 calcul des coefficients d'interpolation des reactions
 
	 mrd=4
	 call pp1dn(nreac_tab,t_t,tt,tr,nt,nrt,mrd,t_t(1),knot,l,drt,f,st,rt,
     1	.false.)
c	 write(6,2000)(tr(i),i=1,nrt)
c	 write(6,2000)(tt(i),i=1,knot)
 
c	 initialisation des energies, des puissances d'ecran, des coefficients
c	 les indices correspondent aux numeros des reactions
 
	 q0(1)=1.172		!PP		cf. B. Pichon
	 pecran(1)=1
	 coef(1)=1./2.
 
	 q0(2)=5.494
	 pecran(2)=1
	 coef(2)=1.
 
	 q0(3)=12.860
	 pecran(3)=4
	 coef(3)=1./2.
 
	 q0(4)=1.588		!CNO
	 pecran(4)=4
	 coef(4)=1.
 
	 q0(5)=17.346
	 pecran(5)=3
	 coef(5)=1./2.
 
	 q0(6)=0.0497	!cf. B. Pichon
	 pecran(6)=0
	 coef(6)=1.
 
	 q0(7)=0.137+11.261+0.092	!cf. B. Pichon
	 pecran(7)=4
	 coef(7)=1.
 
	 q0(8)=1.9435+1.508	!cf. B. Pichon
	 pecran(8)=6
	 coef(8)=1.
 
	 q0(9)=7.55063		!cf. B. Pichon
	 pecran(9)=6
	 coef(9)=1.
 
	 q0(10)=7.2971+1.757	!cf. B. Pichon
	 pecran(10)=7
	 coef(10)=1.
 
	 q0(11)=12.128
	 pecran(11)=7
	 coef(11)=1.
 
	 q0(12)=4.96561		!cf. B. Pichon
	 pecran(12)=7
	 coef(12)=1.
 
	 q0(13)=0.60035+1.761	!cf. B. Pichon
	 pecran(13)=8
	 coef(13)=1.
 
	 q0(14)=1.1907		!cf. B. Pichon   (inchange)
	 pecran(14)=8
	 coef(14)=1.
 
         q0(15)=0.		!CNO chaud non incorpore
         pecran(15)=7
         coef(15)=1.
 
c	 Valeur C.&F. brute cad sans tenir compte
c	 du papier de V. Landre et de la beta, ajout de 1.76 pour beta+
 
         q0(16)=5.607+1.76
         pecran(16)=8
         coef(16)=1.
 
         q0(17)=7.994
         pecran(17)=8
         coef(17)=1.
 
         q0(18)=8.114
         pecran(18)=9
         coef(18)=1.
 
         q0(19)=12.848
         pecran(19)=9
         coef(19)=1.
 
         q0(20)=3.980
         pecran(20)=8
         coef(20)=1.
 
	 q0(21)=7.275		!3 alpha
	 pecran(21)=8	!facteur ro**2
	 coef(21)=1./6.
 
	 q0(22)=7.162
	 pecran(22)=12
	 coef(22)=1.
 
	 q0(23)=4.734
	 pecran(23)=16
	 coef(23)=1.
 
         q0(24)=9.312
         pecran(24)=20
         coef(24)=1.
 
         q0(25)=2.216
         pecran(25)=12
         coef(25)=1.
 
         q0(26)=0.590
         pecran(26)=16
         coef(26)=1.
 
         q0(27)=4.415+1.76		!1.76 pour beta+
         pecran(27)=14
         coef(27)=1.
 
         q0(28)=9.669
         pecran(28)=16
         coef(28)=1.
 
         q0(29)=-0.481
         pecran(29)=20
         coef(29)=1.
 
         q0(30)=10.612
         pecran(30)=20
         coef(30)=1.
 
 
	 do i=1,nreac
	  q0(i)=q0(i)*eve*1.d6/amu	!energie des reactions en erg/reaction
	 enddo
c	 write(6,2000)q0
 
	 t_inf=exp(t_t(1))		!temperature minimale pour les reactions
	 t_infi=t_inf			!tinfi: t_inf interne a la routine
c	 write(6,2000)t,t_inf
c	 write(6,*)'fin initialisation taux_reac'
c	 pause'taux_reac'
 
	endif
 
c	write(6,2000)t,t_inf,t_infi
c	pause'taux_reac'
	if(t .lt. t_infi)then
	 do i=1,nreac
	  r(i)=1.d-100
	  rt(i)=0.
	  rro(i)=0.
	  rx(i)=0.
	  q(i)=0.
	  qt(i)=0.
	  qro(i)=0.
	  qx(i)=0.
	 enddo
	 return
	endif
 
c--------------------------------------------------------------------------
c	effet d'ecran
 
	zeta=(x+3.)/2.
	decr=.188*sqrt(ro*zeta/(t*1.d-6)**3)
	ecran=exp(decr)
	if(deriv)then
	 decrt=-3./2.*decr/t			!a ecran pres
	 decrro=decr/ro/2.			!a ecran pres
	 decrx=decr/zeta/2./2.			!a ecran pres
	 decrxx=decrx/4./zeta*(decr-1./zeta)
c	 write(6,*)'t, ro, x, ecran, decrx'
c	 write(6,2000)t, ro, x, ecran, decrx
	endif
 
c--------------------------------------------------------------------------
c	interpolation en ln t
 
	call pp1dn(nreac_tab,t_t,tt,tr,nt,nrt,mrd,log(t),knot,l,drt,f,st,r,
     1	.true.)
 
c        do i=1, nreac
c        print*, 'r(', i, ')', r(i)
c        end do
 
c	reactions et derivees
 
	do i=1,nreac
	 r(i)=exp(r(i))*ro*ecran**pecran(i)*coef(i)
	 if(deriv)then
	  rt(i)=r(i)*(drt(i)/t+pecran(i)*decrt)
	  rro(i)=r(i)*(pecran(i)*decrro+1./ro)
	  rx(i)=r(i)*pecran(i)*decrx
	  rxx(i)=r(i)*pecran(i)*decrxx
	 endif
c	 write(6,2000)r(i)
	enddo	!i
 
c	write(6,*)'t,ro,r(15)'
c	write(6,2000)t,ro,r(15)
 
	r(21)=r(21)*ro
	if(deriv)then
	 rt(21)=rt(21)*ro
	 rro(21)=r(21)*(pecran(21)*decrro+2./ro)	!ro**2 pour reaction 15
	 rx(21)=rx(21)*ro
	 rxx(21)=rxx(21)*ro
	endif
 
	do i=1,nreac
	 q(i)=r(i)*q0(i)
	 if(deriv)then
	  qt(i)=rt(i)*q0(i)
	  qro(i)=rro(i)*q0(i)
	  qx(i)=rx(i)*q0(i)
	 endif
	enddo
 
	return
 
	end
 
